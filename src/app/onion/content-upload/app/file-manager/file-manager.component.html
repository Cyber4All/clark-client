<div class="top-wrapper">
  <div class="file-breadcrumb">
    <span *ngIf="currentPath.length" class="link" (click)="jumpTo(0, true)">Root</span>
    <ng-container *ngFor="let path of currentPath; let i=index;">
      <span>
        <i class="far fa-chevron-right arrow"></i>
      </span>
      <span class="link" (click)="jumpTo(i)">{{path}}</span>
    </ng-container>
  </div>
  <div class="view-switcher">
    <span *ngIf="view==='list'" (click)="view='grid'" class="button clean">
      <i class="fas fa-th icon-clean"></i>
    </span>
    <span *ngIf="view==='grid'" (click)="view='list'" class="button clean">
      <i class="fas fa-list icon-clean"></i>
    </span>
  </div>
</div>
<div (click)="openDropzone($event)" class="flex-wrapper dz-clickable" [ngClass]="{empty: !(currentNode$| async)?.children.length && !(currentNode$| async)?.files.length}">
  <div *ngIf="!(currentNode$| async)?.children.length && !(currentNode$| async)?.files.length" class="dropzone-message">
    <div class="file-icons">
      <i class="fal fa-image fa-2x"></i>
      <i class="fal fa-file-pdf fa-2x"></i>
      <i class="fal fa-file-word fa-2x"></i>
    </div>
    <span>Drop files and folders or click here</span>
  </div>
  <file-grid-view *ngIf="view==='grid' && ((currentNode$| async)?.children.length || (currentNode$| async)?.files.length)" class="full-width dz-clickable" [node$]="currentNode$"
    (emitPath)="openFolder($event)"></file-grid-view>
  <file-list-view *ngIf="view==='list' && ((currentNode$| async)?.children.length || (currentNode$| async)?.files.length)" class="full-width dz-clickable" [node$]="currentNode$"
    (emitPath)="openFolder($event)"></file-list-view>
</div>

<context-menu (close)="editDescription=false" #fileOptions>
  <ng-template contextMenuItem passive="true">
    <div *ngIf="!editDescription" class="context-item" (click)="editDescription=true">
      <div>
        Edit description
      </div>
      <div>
        <i class="far fa-edit"></i>
      </div>
    </div>
  </ng-template>
  <ng-template contextMenuItem (execute)="deleteFile($event.item)">
    <div *ngIf="!editDescription" class="context-item bad">
      <div>
        Delete
      </div>
      <div>
        <i class="far fa-trash-alt"></i>
      </div>
    </div>
  </ng-template>

  <ng-template let-item contextMenuItem passive="true">
    <div *ngIf="editDescription" class="context-item stacked">
      <form #decriptionInput="ngForm" (submit)="saveDescription(description.value, item); closeContextMenu()">
        <div class="description-input">
          <input #description name="description" ([ngModel])="item?.description" type="text" name="file-description" placeholder="Enter description"
            [value]="item?.description ? item?.description : ''" />
        </div>
        <div class="buttons">
          <button type="button" class="button bad slim" (click)="closeContextMenu()">
            Cancel
          </button>
          <button type="button" class="button good slim" (click)="saveDescription(description.value, item); closeContextMenu()">
            Save
          </button>
        </div>
      </form>
    </div>
  </ng-template>

</context-menu>
