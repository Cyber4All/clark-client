<div class="dropdown-wrapper mobile-only">
  <button class="options-button" (click)="toggleOptionsMenu()">
    <i class="fa fa-bars"></i> Options
  </button>

  <div class="dropdown-content" *ngIf="showOptions" (click)="$event.stopPropagation()">
    <!-- Clear all filters -->
    <span class="filters-clear-all">
      <a (click)="clearAllFilters()">Clear all filters</a>
    </span>

    <!-- Status Filter -->
    <div class="dropdown-item">
      <button class="button neutral filters-button" (click)="toggleStatusMenu()"
        [ngClass]="{ 'filters-button--down': statusMenuActive }">
        <span class="filter-badge" *ngIf="statusFilters.size">
          {{ statusFilters.size }}
        </span>
        Status <i class="fas fa-chevron-down"></i>
      </button>
      <!-- Replacing clark-context-menu with a simple *ngIf -->
      <div class="filter-status__container filter-dropdown" *ngIf="statusMenuActive" (click)="$event.stopPropagation()">
        <ul>
          <li *ngFor="let status of statuses" [ngClass]="status" (click)="toggleStatusFilter([status])">
            <div *ngIf="statusFilters.has(status)" class="indicator"></div>
            <i [ngClass]="getStatusIcon(status)"></i>
            {{ status.replace('_', ' ') | titlecase }}
          </li>
        </ul>
      </div>
    </div>

    <!-- Length Filter -->
    <div class="dropdown-item">
      <button class="button neutral filters-button" (click)="toggleLengthMenu()"
        [ngClass]="{ 'filters-button--down': lengthMenuActive }">
        <span class="filter-badge" *ngIf="lengthFilters.size">
          {{ lengthFilters.size }}
        </span>
        Length <i class="fas fa-chevron-down"></i>
      </button>
      <div class="filter-status__container filter-dropdown" *ngIf="lengthMenuActive" (click)="$event.stopPropagation()">
        <ul>
          <li *ngFor="let length of lengths" [ngClass]="length" (click)="toggleLengthFilter([length])">
            <div *ngIf="lengthFilters.has(length)" class="indicator"></div>
            {{ length.replace('_', ' ') | titlecase }}
          </li>
        </ul>
      </div>
    </div>

    <!-- Last Updated Sort -->
    <div class="dropdown-item">
      <button class="button neutral filters-button" (click)="toggleSortDateMenu()"
        [ngClass]="{ 'filters-button--down': sortDateMenuActive }">
        Last Updated <i class="fas fa-chevron-down"></i>
      </button>
      <div class="filter-status__container filter-dropdown" *ngIf="sortDateMenuActive"
        (click)="$event.stopPropagation()">
        <ul>
          <li (click)="setLastUpdatedSort(-1)">
            <span *ngIf="selectedLastUpdatedSortType === -1" class="indicator"></span>
            Newest
          </li>
          <li (click)="setLastUpdatedSort(1)">
            <span *ngIf="selectedLastUpdatedSortType === 1" class="indicator"></span>
            Oldest
          </li>
        </ul>
      </div>
    </div>

    <!-- Rating Sort -->
    <div class="dropdown-item">
      <button class="button neutral filters-button" (click)="toggleSortRatingMenu()"
        [ngClass]="{ 'filters-button--down': sortRatingMenuActive }">
        Rating <i class="fas fa-chevron-down"></i>
      </button>
      <div class="filter-status__container filter-dropdown" *ngIf="sortRatingMenuActive"
        (click)="$event.stopPropagation()">
        <ul>
          <li (click)="setRatingSort(-1)">
            <span *ngIf="selectedRatingSortType === -1" class="indicator"></span>
            Highest Rated
          </li>
          <li (click)="setRatingSort(1)">
            <span *ngIf="selectedRatingSortType === 1" class="indicator"></span>
            Lowest Rated
          </li>
        </ul>
      </div>
    </div>

  </div>
</div>

<!-- DESKTOP VIEW -->
<div class="desktop-filter desktop-only" (click)="$event.stopPropagation()">
  <!-- Clear all filters -->
  <span class="filters-clear-all">
    <a (click)="clearAllFilters()">Clear all filters</a>
  </span>

  <!-- Status Filter -->
  <div class="filter-group">
    <button class="button neutral filters-button" (click)="toggleStatusMenu()"
      [ngClass]="{ 'filters-button--down': statusMenuActive }">
      <span class="filter-badge" *ngIf="statusFilters.size">
        {{ statusFilters.size }}
      </span>
      Status <i class="fas fa-chevron-down"></i>
    </button>
    <div class="filter-status__container filter-dropdown" *ngIf="statusMenuActive" (click)="$event.stopPropagation()">
      <ul>
        <li *ngFor="let status of statuses" [ngClass]="status" (click)="toggleStatusFilter([status])">
          <div *ngIf="statusFilters.has(status)" class="indicator"></div>
          <i [ngClass]="getStatusIcon(status)"></i>
          {{ status.replace('_', ' ') | titlecase }}
        </li>
      </ul>
    </div>
  </div>

  <!-- Length Filter -->
  <div class="filter-group">
    <button class="button neutral filters-button" (click)="toggleLengthMenu()"
      [ngClass]="{ 'filters-button--down': lengthMenuActive }">
      <span class="filter-badge" *ngIf="lengthFilters.size">
        {{ lengthFilters.size }}
      </span>
      Length <i class="fas fa-chevron-down"></i>
    </button>
    <div class="filter-status__container filter-dropdown" *ngIf="lengthMenuActive" (click)="$event.stopPropagation()">
      <ul>
        <li *ngFor="let length of lengths" [ngClass]="length" (click)="toggleLengthFilter([length])">
          <div *ngIf="lengthFilters.has(length)" class="indicator"></div>
          {{ length.replace('_', ' ') | titlecase }}
        </li>
      </ul>
    </div>
  </div>

  <!-- Last Updated Sort -->
  <div class="filter-group">
    <button class="button neutral filters-button" (click)="toggleSortDateMenu()"
      [ngClass]="{ 'filters-button--down': sortDateMenuActive }">
      Last Updated <i class="fas fa-chevron-down"></i>
    </button>
    <div class="filter-status__container filter-dropdown" *ngIf="sortDateMenuActive" (click)="$event.stopPropagation()">
      <ul>
        <li (click)="setLastUpdatedSort(-1)">
          <span *ngIf="selectedLastUpdatedSortType === -1" class="indicator"></span>
          Newest
        </li>
        <li (click)="setLastUpdatedSort(1)">
          <span *ngIf="selectedLastUpdatedSortType === 1" class="indicator"></span>
          Oldest
        </li>
      </ul>
    </div>
  </div>

  <!-- Rating Sort -->
  <div class="filter-group">
    <button class="button neutral filters-button" (click)="toggleSortRatingMenu()"
      [ngClass]="{ 'filters-button--down': sortRatingMenuActive }">
      Rating <i class="fas fa-chevron-down"></i>
    </button>
    <div class="filter-status__container filter-dropdown" *ngIf="sortRatingMenuActive"
      (click)="$event.stopPropagation()">
      <ul>
        <li (click)="setRatingSort(-1)">
          <span *ngIf="selectedRatingSortType === -1" class="indicator"></span>
          Highest Rated
        </li>
        <li (click)="setRatingSort(1)">
          <span *ngIf="selectedRatingSortType === 1" class="indicator"></span>
          Lowest Rated
        </li>
      </ul>
    </div>
  </div>
</div>