<div class="container">
    <h1 class="title">CyberSkills2Work Collection Statistics Dashboard</h1>
  
    <clark-dashboard-stats [collectionName]="'cyberskills2work'" [displayCharts]="true"></clark-dashboard-stats>

  <div class="downloads-header">
    <h2>All Learning Objects</h2>
    <div class="buttons">
      <!--
        When filterQuery is emitted, we will always load the first page
        because the contents are bound to change and there's no guarantee
        that the currPage will have any content to serve.

        We do the same for clearAll once filterQuery is empty.
      -->
      <clark-cyberskills-filters class="buttons" (filterQuery)="handlePaginationAndLoadItems(1, $event)"
        (clearAll)="handlePaginationAndLoadItems(1, {})"></clark-cyberskills-filters>

      <button class="button good" (click)="openCsvGenModal()">Download CSV of Released Learning Objects</button>
    </div>
  </div>

  <div class="learning-object-table">
    <div class="header">
      <span>Status</span>
      <span>Length</span>
      <span>Name</span>
      <span>Last Updated</span>
      <span>Downloads</span>
      <span>Rating</span>
      <span></span>
    </div>

    <div *ngFor="let learningObject of learningObjects" class="row">
      <!-- Status -->
      <div class="status" tabindex="0"
        [attr.aria-label]="'Learning Object Status: ' + learningObject.status + '. ' + statusDescription"
        [ngClass]="learningObject.status">
        <span *ngIf="learningObject.status === 'unreleased'"><i class="fas fa-eye-slash"></i></span>
        <span *ngIf="learningObject.status === 'waiting'"><i class="fas fa-hourglass"></i></span>
        <span *ngIf="learningObject.status === 'review'"><i class="fas fa-sync"></i></span>
        <span *ngIf="learningObject.status === 'proofing'"><i class="fas fa-shield"></i></span>
        <span *ngIf="learningObject.status === 'released'"><i class="fas fa-eye"></i></span>
        <span *ngIf="learningObject.status === 'rejected'"><i class="fas fa-ban"></i></span>
        <span *ngIf="learningObject.status === 'accepted_minor'"><i class="fas fa-check-double"></i></span>
        <span *ngIf="learningObject.status === 'accepted_major'"><i class="fas fa-check"></i></span>
      </div>

      <!-- Length -->
      <div class="info">
        <clark-details-splash-length [length]="learningObject.length"></clark-details-splash-length>
      </div>

      <!-- Name -->
      <div class="info name">{{ learningObject.name }}</div>

      <!-- Last Updated -->
      <div class="info date">
        {{ learningObject.date | date:'MM/dd/yyyy' }}
      </div>

      <!-- Downloads (only if released) -->
      <div class="info">
        <span *ngIf="learningObject.status === 'released'">{{ learningObject.metrics.downloads }}</span>
      </div>

      <!-- Rating (only if released) -->
      <div class="info">
        <clark-rating-stars *ngIf="learningObject.status === 'released'"
          [rating]="learningObject.averageRating ? learningObject.averageRating : 0" color="gold"></clark-rating-stars>
      </div>

      <!-- Actions -->
      <div class="info">
        <a [routerLink]="['/details', learningObject.author.username, learningObject.cuid]" class="details-link">View
          Details ></a>
      </div>
    </div>
  </div>
  <clark-pagination [lastPageNumber]="lastPage" [currentPageNumber]="currPage"
    (newPageNumberClicked)='handlePaginationAndLoadItems($event)'></clark-pagination>
</div>
<cube-footer></cube-footer>

<clark-csv-gen-modal *ngIf="showCsvModal" (closed)="closeCsvModal()">
</clark-csv-gen-modal>