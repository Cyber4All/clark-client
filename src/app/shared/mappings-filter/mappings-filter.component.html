<div class="mappings-filter" (click)="preventClose()">
  <div class="search-bar" [ngClass]="{'focus': focused}">
    <input #searchInput type="search" placeholder="Search..." (focus)="focused = resultsDown = true;" (blur)="focused = false;" />
    <div class="search-sources" tip="Filter results by sources" tipLocation="above" (click)="sourcesDown = true;">
      <i class="far fa-globe-americas"></i>
      <i class="far fa-angle-down"></i>
    </div>
    <div class="search-button">
      <i class="far fa-search"></i>
    </div>
  </div>
  <div *ngIf="focused || resultsDown" class="result-drop main">
    <ng-container *ngIf="!loading && outcomes?.length; else noResults">
      <ul>
        <ng-container *ngFor="let c of outcomes">
          <li class="section">
            {{ c.source }}
          </li>
          <li *ngFor="let o of c.outcomes" tip="{{o.outcome}}" tipLocation="right">
            {{ o.name }}
          </li>
        </ng-container>
      </ul>
    </ng-container>
  </div>
  <div *ngIf="sourcesDown" class="result-drop source">
    <ul>
      <li *ngFor="let s of sources">{{ s }}</li>
    </ul>
  </div>
</div>

<ng-template #noResults >
  <ng-container *ngIf="loading; else introTemplate">
    <div class="loading">
      <i class="far fa-spinner-third fa-spin"></i>
    </div>
  </ng-container>
</ng-template>

<ng-template #introTemplate>
  <div *ngIf="outcomes" class="intro">
    We couldn't find anything for that query!
  </div>
</ng-template>