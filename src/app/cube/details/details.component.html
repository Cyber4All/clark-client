<div *ngIf="learningObject" class="details-wrapper" [ngClass]="learningObject.length">
  <cube-details-splash [canRate]="loggedin && auth.user.emailVerified" [ratings]="ratings" [averageRating]="averageRating" [learningObject]="learningObject" (showNewRating)="showAddRating = $event;"></cube-details-splash>
  <div class="flex">
    <div class="content">
      <div class="description">
        <div class="title">Description</div>
        <p [innerHtml]="learningObject.goals[0].text"></p>
      </div>
      <cube-outcomes-detail-view [outcomes]="learningObject.outcomes"></cube-outcomes-detail-view>
      <cube-children-detail-view *ngIf="learningObject.children?.length > 0" [length]="learningObject.length" [children]="learningObject.children"></cube-children-detail-view>
      <div class="materials">
        <onion-file-details [length]="learningObject.length" [materials]="learningObject.materials"></onion-file-details>
      </div>
      <div #ratingsWrapper class="ratings">
        <button *ngIf="!isMobile && loggedin" tip="You must verify your email in order to review learning objects." tipDisabled="{{ auth.user.emailVerified }}"
          class="button good" (click)="showAddRating = auth.user.emailVerified">{{ userRating.date ? 'Edit your' :
          'Write a'}} review <i class="far fa-pencil"></i></button>
        <clark-learning-object-ratings [ratings]="ratings" [averageRating]="averageRating" [loggedIn]="loggedin" (editRating)="showAddRating = true;"
          (deleteRating)="deleteRating($event)" (reportRating)="reportRating($event)"></clark-learning-object-ratings>
      </div>
    </div>
    <div class="sidebar">
      <cube-details-action-panel [learningObject]="learningObject"></cube-details-action-panel>
      <cube-details-included-in [learningObject]="learningObject"></cube-details-included-in>
    </div>
  </div>
</div>
<div *ngIf="loggedin" class="new-rating-wrapper" [ngClass]="{'active': showAddRating}" (click)="showAddRating = false;">
  <div class="new-rating" (click)="$event.stopPropagation()">
    <div class="close-new-rating" (click)="showAddRating = false;"><i class="far fa-times"></i></div>
    <div class="title">Rate this Learning Object</div>
    <clark-new-rating [rating]="userRating" [editing]="userRating.date ? true : false" (setRating)="submitNewRating($event)"
      (cancelRating)="showAddRating = false;"></clark-new-rating>
  </div>
</div>
